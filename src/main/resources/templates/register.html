<!DOCTYPE HTML>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
    <head>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
              crossorigin="anonymous"/>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"crossorigin="anonymous"></script>
        <link rel="stylesheet" href="../static/css/style.css"/>
        <link rel="stylesheet" type="text/css" media="all" href="css/style.css" th:href="@{/css/style.css}"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />

        <title>Register Form</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    </head>
    <body>
        <div class="mybody">
           
            <div class="myform">
                <div class="register">
                    <img src="images/stamp.png" width="30x">
                        <h2>Register</h2>
                </div>
                <form th:action="@{/registerUser}" th:object="${newUser}" method="post">
                    <!--
                    -->                    <div class="input-group">
                        <i class="fas fa-user username-icon"></i>
                        <input onkeyup="validcheck()" type="text" name="username" path="userName" th:field="*{userName}" id="username"
                               class="form-control" placeholder="Username" aria-label="Username"
                               aria-describedby="basic-addon1" required minlength="3" />

                    </div>
                    <p id="usernameError"></p><!--
 
                    -->                    <div class="input-group">
                        <i class="fas fa-envelope"></i>

                        <input onkeyup="validcheck()" type="text" name="email" path="email"  th:field="*{email}" id="email" class="form-control"
                               placeholder="Email" aria-label="Email" aria-describedby="basic-addon1" required />
                    </div><!--
                    -->                    <p id="emailerror"></p><!--
                    
                    -->                    <div class="input-group">
                        <i class="fas fa-key"></i>
                        <input onkeyup="validcheck()" type="password" th:field="*{userPassword}" id="password"
                               class="form-control" placeholder="Password" aria-label="Username"
                               aria-describedby="basic-addon1" required /><i onclick="showpass()" id="showpass"
                               class="fas fa-eye"></i>
                    </div><!--
                    -->                    <p id="passworderror"></p><!--
                    -->                    <div class="input-group mb-3">
                        <i class="fas fa-lock"></i>
                        <input onkeyup="validcheck()" type="password" class="form-control" id="password2" 
                               placeholder="Re-type Password" aria-label="Username" aria-describedby="basic-addon1" required>
                    </div><!--
                    -->                    <p id="passworderror2"></p><!--
                    -->                    <div class="input-group mb-3">
                        <div class="input-group-prepend">

                            <img src="images/vet-dog.png" width="35px">
                                <div class="input-group-text noborder">
                                    <input type="checkbox" onclick="onChangeHandler()"
                                           aria-label="Checkbox for following text input">
                                </div>
                        </div>
                        <input type="text" value="Create a Vet Acount" class="form-control"
                               aria-label="Text input with checkbox" readonly>

                    </div>
                    <div class="input-group mb-3" id="myDIV" hidden>
                        <i class="fas fa-certificate"></i>
                        <input type="text" class="form-control" placeholder="Enter Credential Id" aria-label="Username"
                               aria-describedby="basic-addon1">
                    </div>
                    <div class="center">
                        <button type="submit" id="submitbtn" class=" btn btn-primary" disabled>Submit</button>
                    </div>
                </form>
            </div>
            <div class="squirle">


            </div>
        </div>


        <script>
            function onChangeHandler() {
                var x = document.getElementById("myDIV");
                if (x.hidden === true) {
                    x.hidden = false;
                } else {
                    x.hidden = true
                }
            }


            function validcheck() {
                var letters = /^[a-zA-Z\s]*$/;
                var username = document.getElementById("username").value
                let usernameError = "";
                let displayusernameError = document.getElementById("usernameError")
                var email = document.getElementById("email").value
                let emailError = "";
                let displayemailerror = document.getElementById("emailerror")
                let password = document.getElementById("password").value
                let passwordError = "";
                let displaypassworderror = document.getElementById("passworderror")
                let password2 = document.getElementById("password2").value
                let passwordError2 = "";
                let displaypassworderror2 = document.getElementById("passworderror2")
                let submitbtn = document.getElementById("submitbtn")



                if (username.length < 3 || username.length > 20) {
                    usernameError = "Name must be between 3-20 letters"
                }
                if (username === null || username.trim() === "") {
                    usernameError = "this field cannot be empty"
                }
                if (!username.match(letters)) {
                    usernameError = "this field should only contain letters"
                }

                displayusernameError.innerText = usernameError


                if (email === null || email === "") {
                    emailError = "this field cannot be empty"
                } else
                if (email.length < 4 || username.length > 20 || email.includes(" ")) {
                    emailError = "invalid email"
                } else

                if (!email.includes('@')) {
                    emailError = "invalid email"
                }

                displayemailerror.innerText = emailError



                if (password.length < 6) {
                    passwordError = "password should be  6 or more characters"
                }
                if (password === null || password === "") {
                    passwordError = "this field cannot be empty"
                }
                if (password2 !== password) {
                    passwordError2 = "no matching password please retype"
                }

                displaypassworderror.innerText = passwordError
                displaypassworderror2.innerText = passwordError2

                if (usernameError.length == 0 && emailError.length === 0 && passwordError.length == 0
                        && passwordError2.length == 0) {
                    submitbtn.removeAttribute("disabled")
                } else {
                    submitbtn.setAttribute("disabled", true)
                }



            }
            function showpass() {
                var x = document.getElementById("password");
                var y = document.getElementById("showpass");
                if (x.type === "password") {
                    x.type = "text";
                    y.style.opacity = 1;
                } else {
                    x.type = "password";
                    y.style.opacity = 0.3;
                }
            }

        </script>
    </body>
</html>

